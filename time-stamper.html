<!DOCTYPE HTML><html><head> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-120060045-1"></script> <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);} gtag('js',new Date());gtag('config','UA-120060045-1');</script> <title>Time Stamper</title><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /> <!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]--><link rel="stylesheet" href="assets/css/main.css" /> <!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]--> <!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]--><style>.no-js #loader{display:none}.js #loader{display:block;position:absolute;left:100px;top:0}.se-pre-con{position:fixed;left:0px;top:0px;width:100%;height:100%;z-index:9999;background:url('images/ripple.gif') center no-repeat}</style></head><body><div class="se-pre-con"></div> <header id="header"> <nav id="nav"><ul class="actions"><li style="float: right"><a class="links icon fa-arrow-left" href="projects.html"></a></li></ul> </nav> </header> <section class="wrapper"><div class="inner no-select"> <header class="major"><h2 class="">SECURE TIME-STAMPER ON FPGA</h2><p class="align-justify" style="color:#272f36">A high-speed, time-stamping authority system using RSA encryption and implemented on an FPGA.</p><p style="color:#272f36"><i>Built Using</i>&nbsp;:&nbsp;Altera Quartus Design Software with VHDL</p> </header><div class="content"><div class="12u"> <span class="image fit-eighty"> <img class="image fit-eighty" src="images/projects/fpga/title_fit_dsd_1-min.PNG" alt=""/> </span></div> <br><p class="align-justify">The high-speed timestamp authority system accepts a message from some source, generates a time-stamp based on the time and date of the message receipt, and appends a digital signature to the (message + timestamp). The collection of signature, time-stamp, and message is sent back to the message source.</p><p class="align-justify">The system is meant to be used by a trusted authority to provide an authentic time-stamp that is solely attached to that message. This will allow future viewers of the message to know when that particular message was created. A vital part of the authenticated time stamp circuit is the generation of a signature that is unique to the party sending the message. The signature generation process that we use is based on the RSA decryption algorithm.</p><p class="align-justify"> The RSA algorithm implements a “public key” protocol, in which the receiver has two personal numerical keys; a private key known only to that person and a public key known to everybody. Since the public key is publically known, it can be used by a sender to encrypt a message. In the RSA approach, only the intended receiver can decrypt this message using his own private key. This ensures that the sender can transmit a message that only the intended receiver can decrypt.</p><p class="align-justify">The authenticated time stamp circuit (g22_complete_system.bdf) employs the Public Key idea in the reverse fashion, to ensure that a particular publicly readable message is guaranteed to have been generated by a specific party (the “trusted authority”). To realize this, the trusted authority uses its private key (d = 13205 in our system application) to encrypt a message. In the RSA approach, anyone can decrypt this message using the trusted authority’s public key (d = 5 in our implementation). If the message was encrypted by someone other than the so-called trusted authority (using a different key of course), then the intended receiver would not be able to decrypt the message using the trusted authority’s public key (since that public key can only decrypt a message that is encrypted by the private key unique to the trusted authority). In this way, the intended receiver would know that the message did not originate from the trusted authority.</p><h4 class="">System Block Diagram</h3><p class="align-justify">The implementation of the complete system is divided into two main parts: timestamp generation and timestamp authentication. Both these processes are controlled by a finite state machine (fsm) controller that responds to a user interface.</p><div class="12u"> <span class="image fit-seventy"> <figure> <img src="images/projects/fpga/fig_1_time_stamper.PNG" alt="" /> <figcaption>Figure 1. <span style="font-weight: normal">Block Diagram of the complete authenticated time-stamp circuit. Refer to Figure 2 for the system controller state diagram.</span></figcaption> </figure> </span></div> <br><p class="align-justify">User Interface allows the user to either initiate the time-stamp generation or authentication process by means of pushbuttons connected to start_gen and start_auth respectively (Figure 1). The system must be reset prior to operating.</p><p class="align-justify">The generation process (start_gen) takes the system controller through the generation process states (Figure 2). LEDs connected to done_gen indicate if time-stamp generation has finished (signature + time-stamp are computed).</p><p class="align-justify">The authentication process (start_auth) takes the system controller through the authentication process states (Figure 2). LEDs connected to done_auth and authenticate (Figure 1) indicate if authentication process has finished (Hash message recalculated -> codeA, and signature decrypted - >codeB) and whether authentication was successful (codeA = codeB?).</p><p class="align-justify">Referring to Figure 1, switches SW9, 8, 7 allow the user to select different Modes that display different information on the 7-segment display (HEX3, 2, 1, 0): time-stamp, signature, CODE A, CODE B, 256-bit message chunks.</p><h4 class="">State Diagram for the System Controller</h4><div class="12u"> <span class="image fit-seventy"> <figure> <img src="images/projects/fpga/fig_2_time_stamper.PNG" alt="" /> <figcaption>Figure 2. <span style="font-weight: normal">State Diagram for the FSM System Controller.</span></figcaption> </figure> </span></div> <br><h4 class="">State Descriptions With Reference to Individual System Components</h4><p class="align-justify">This section gives a detailed description of each state with reference to system components involved in the state being discussed. The functions of these system components are briefly outlined in the following table.</p><div class="12u"> <span class="image fit-seventy"> <figure> <img src="images/projects/fpga/fig_3_time_stamper.PNG" alt="" /> <figcaption>Table 1. <span style="font-weight: normal">Functions of Individual System Components of the Time Stamper System.</span></figcaption> </figure> </span></div> <br><h4 class="">User Interface Controls</h4><p class="align-justify">The user can select what information is displayed on the Altera board LEDs according to Table 2. Figure 3 shows the User Interface Implementation.</p><div class="12u"> <span class="image fit-seventy"> <figure> <img src="images/projects/fpga/table_2_time_stamper.PNG" alt="" /> <figcaption>Table 2. <span style="font-weight: normal">These seven modes enable the user to select what information is displayed on the Altera board LEDs.</span></figcaption> </figure> </span></div> <br><h4 class="">User Interface Implementation</h4><p class="align-justify">The 7-input Mux selects which Mode to display depending on the combinations of switches 7 to 9. If Mode 6 is selected, switches 3 to 6 select which 16-bit chunk of the 256-bit message is displayed.</p><div class="12u"> <span class="image fit-eighty"> <figure> <img src="images/projects/fpga/fig_11_time_stamper-min.PNG" alt="" /> <figcaption>Figure 3. <span style="font-weight: normal">User Interface Implementation.</span></figcaption> </figure> </span></div> <br><h4 class="">System Testing Example</h4><p class="align-justify">All calculations of Message Hash, Signature, CODE A etc. for a given test case were done using Wolfram Alpha. The relevant .mif file for the case to be tested was read and the system uploaded to the Altera board. Signal Tap was used to verify the results.</p><p class="align-justify">Test Case-1 uses message1.mif and a timestamp of 2 seconds to compute the signature and CODE A.</p><div class="12u"> <span class="image fit-seventy"> <img src="images/projects/fpga/test_case_1_time_stamper.PNG" alt="" /> </span></div> <br><div class="12u"> <span class="image fit-seventy"> <figure> <img src="images/projects/fpga/test_case_1_signal_tap_time_stamper.PNG" alt="" /> <figcaption>Figure 4. <span style="font-weight: normal">Signal Tap for Test Case-1: timestamp = 2 sec, signature = 41716, <span style="color: #cc0000; font-weight: normal">codeA = 22D16 = codeB</span></span></figcaption> </figure> </span></div> <br><h4 class="">System Operation Demo</h4><p class="align-justify">This is a step-by-step visual guide for operating the complete Time Stamper system on the Altera board using the Test Case shown earlier.</p><h4 class="">STEP 1. <span style="color: #07548d">Upload the program to the Altera board</span></h4><ol><li>Turn On the Board and make sure it is properly configured: Select the RUN switch for the JTAG MODE.</li><li>Open project folder g22_LAB_1.sof in Quartus and navigate to g22_complete_system.bdf</li><li>Compile g22_complete_system.bdf</li><li>Upload the file to the Altera board: (Tools --> Programmer --> Select "USB-Blaster" as communication hardware--> Click START)</li><li>Once uploaded, make sure the Select Mode is Mode 0: SW9=0, SW8=0, SW7=0 (LEDR9, 8, 7 are turned Off) as shown in the picture below (Figure 5).</li><li>Go to STEP-2</li></ol><div class="12u"> <span class="image fit-eighty"> <figure> <img src="images/projects/fpga/demo_img_1_time_stamper.PNG" alt="" /> <figcaption>Figure 5. <span style="font-weight: normal">Board shown just after the program is uploaded. Mode 0 is selected.</span></figcaption> </figure> </span></div> <br><h4 class="">STEP 2. <span style="color: #07548d">Start the Generation process</span></h4><p class="align-justify"><span style="text-decoration: underline;">Keeping <span style="font-style: italic">Mode 0</span></span>, press Reset (KEY0) and <span style="text-decoration: underline; font-style: italic">precisely after 2 seconds</span>, press the <span style="font-style: italic">Start Generation</span> button (KEY3) to start the Timestamp Generation process (Figure 19). If KEY3 is pressed, and a time other than 2 seconds is displayed on the 7-segment LEDs, that is, the Start Generation button was not precisely pressed after 2 seconds, you will have to press Reset again, wait for 2 seconds, and then press the Start Generation button again to get it right. LEDG6 lights On (Figure 19) when Generation process has finished, that is, CODE A is encrypted (signature is computed) and can be displayed in <span style="font-style: italic">Mode 3</span>.</p><div class="12u"> <span class="image fit-eighty"> <figure> <img src="images/projects/fpga/demo_img_2_time_stamper.PNG" alt="" /> <figcaption>Figure 6. <span style="font-weight: normal">Start Generation button is pressed 2 seconds after pressing Reset. Hence, a Timestamp of 2 seconds is displayed in Mode 0.</span></figcaption> </figure> </span></div> <br><h4 class="">STEP 3. <span style="color: #07548d">Display Signature in Mode 3</span></h4><p class="align-justify">Display the computed signature in Mode 3: SW9=0, SW8=1, SW7=1 (LEDR9 is Off while LEDR8, 7 are On) as shown in the picture below (Figure 7).</p><div class="12u"> <span class="image fit-eighty"> <figure> <img src="images/projects/fpga/demo_img_3_time_stamper.PNG" alt="" /> <figcaption>Figure 7. <span style="font-weight: normal">Signature = 41716 (as previously shown in the test case) displayed in Mode 3.</span></figcaption> </figure> </span></div> <br><h4 class="">STEP 4. <span style="color: #07548d">Start Authentication process</span></h4><p class="align-justify">Press the Start Authentication button. Display <span style="font-style: italic">CODE A</span> by switching to Mode 4: SW9=1, SW8=0, SW7=0 (LEDR9 is On while LEDR8, 7 are Off) as shown in the picture below (Figure 8a). LEDG4 turns On when Authentication has finished. If it was successful: CODE A = CODE B, then LEDG2 will turn On as well. CODE B can be displayed in Mode 5: SW9=1, SW8=0, SW7=1 (LEDR9 is On, LEDR8 Off, LEDR7 is On) as shown in Figure 8b. Mode 0 Start Generation button (KEY3) LEDG6 turns On when Generation process has finished Mode 3 Signature = 41716 corresponding to a Timestamp = 2 seconds.</p><div class="12u"> <span class="image fit-eighty"> <figure> <img src="images/projects/fpga/demo_img_4_time_stamper.PNG" alt="" /> <figcaption>Figure 8a. <span style="font-weight: normal">(CODE A) = 22D16 displayed in Mode 4.</span></figcaption> </figure> </span></div> <br><div class="12u"> <span class="image fit-eighty"> <figure> <img src="images/projects/fpga/demo_img_5_time_stamper.PNG" alt="" /> <figcaption>Figure 8b. <span style="font-weight: normal">CODE B displayed in Mode 5.</span></figcaption> </figure> </span></div> <br><h4 class="">STEP 5. <span style="color: #07548d">Display parts of Message in Mode 6</span></h4><p class="align-justify">Mode 6 can display different 16-bit chunks of the 256-bit message depending on the combinations of switches SW6, 5, 4, 3. We will demonstrate displaying the first two 16-bit chunks from message1.mif:</p><ul style="margin-left: auto; margin-right: auto; width: 80%"><li><span style="">1st 16-bit chunk:</span> 0110 0001 0110 0000 (6160)</li><li><span style="">2nd 16-bit chunk:</span> 0110 0011 0110 0010 (6362)</li></ul><ol><li>Select Mode 6: SW9=1, SW8=1, SW7=0 (LEDR9, 8 are On while LEDR7 is Off)</li><li>Display the first 16-bit message chunk by selecting SW6, 5, 4, 3 = 0000 (Figure 9a)</li><li>Display the second 16-bit message chunk by selecting SW6, 5, 4, 3 = 0001 (Figure 9b)</li></ol><div class="12u"> <span class="image fit-seventy"> <figure> <img src="images/projects/fpga/demo_img_6_time_stamper.PNG" alt="" /> <figcaption>Figure 9a. <span style="font-weight: normal">Mode 6 displaying 1st 16-bit chunk: 0110 0001 0110 0000 (6160).</span></figcaption> </figure> </span></div> <br><div class="12u"> <span class="image fit-seventy"> <figure> <img src="images/projects/fpga/demo_img_7_time_stamper.PNG" alt="" /> <figcaption>Figure 9b. <span style="font-weight: normal">Mode 6 displaying 2nd 16-bit chunk: 0110 0011 0110 0010 (6362).</span></figcaption> </figure> </span></div> <br><h4 class="">Note</h4><p class="align-justify">To redo the generation and authentication process for the same message, the user needs to press the Reset pushbutton (Figure 3).</p><p class="align-justify">To perform the generation and authentication processes for another message, the user needs to change the .mif file of the lpm_rom in both the <span style="font-style: italic">g22_Hash_Message</span> and <span style="font-style: italic">Mode 6</span> components. Then recompile the g22_complete_system.bdf circuit and then use the programmer to upload to the Altera board.</p></div></div> </section> <footer id="" style="text-align:center; font-size:10pt;"><p class="copyright">Copyright &copy; 2016 Salman Hashmi. All rights reserved.<br /></p> </footer> <script src="assets/js/jquery.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.2/modernizr.js"></script> <script>$(window).load(function(){$(".se-pre-con").fadeOut("slow");;});</script> <script src="assets/js/jquery.dropotron.min.js"></script> <script src="assets/js/jquery.scrollex.min.js"></script> <script src="assets/js/skel.min.js"></script> <script src="assets/js/util.js"></script> <!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]--> <script src="assets/js/main.js"></script> <script>function goBack(){window.history.back();}</script> </body></html>